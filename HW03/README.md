# ДЗ №3: решение задачи прогноза временного ряда с оценкой неопределенностей и сравнением моделей

Дедлайн - **05.12.2025 23:59:59**

ДЗ сдавать в виде Jupyter-ноутбука с выполняемым кодом и комментариями, описывающими/обосновывающими происходящее.

Тема: исследование задачи **прогноза временного ряда** на данных одной из коллекций, используемых в курсе, с использованием набора моделей:

- не менее **двух моделей классического машинного обучения** (Linear Regression, Random Forest, Gradient Boosting, CatBoost, KNN и др.);
- **многослойного перцептрона (MLP) в реализации sklearn**.

Ключевой особенностью задания является **оценка неопределённостей меры качества** (например, RMSE или MAE) с использованием бутстрепа - аналогично ДЗ №2. Необходимо сравнить модели с учётом **доверительных интервалов**, и сделать вывод о статистически значимых различиях.

Не требуется:

- оценивать неопределённость целевой переменной;
- оценивать неопределённости параметров моделей.

------

## **В решении ожидается наличие следующих ключевых составляющих:**

### **1. Формулировка задачи**

- постановка задачи (прогноза временного ряда);
- описание целевой переменной и используемых признаков: типы переменных, размерность;
- формулировка меры качества (например, RMSE / MAE / MAPE);
- формулировка меры неопределённости (доверительный интервал на меру качества, полученный бутстрепом).

### **2. Разведочный анализ данных**

- визуализация временных рядов целевой переменной и признаков;
- (опционально) анализ и вычет тренда, сезонности, автокорреляции — при необходимости;
- разбиение данных на train/test с учетом автокорреляции во времени;
- (опционально) генерация временн**ы**х признаков (lag-признаки, rolling mean, rolling std и др.).

### **3. Формирование признакового описания**

- выбранный набор лагов и скользящих окон;
- объяснение логики выбора;
- визуализация сформированных таблиц объекты-признаки.

### **4. Обучение нескольких моделей**

Обучить не менее 3 моделей + как минимум 1 базовую модель:

- **2+ классических моделей**, например:
  - Random baseline
  - Constant baseline
  - Persistent model
  - Linear Regression
  - Random Forest Regressor
  - Gradient Boosting Regressor
  - KNN Regressor
  - CatBoost
- **MLP** (реализация sklearn: sklearn.neural_network.MLPRegressor, sklearn.neural_network.MLPClassifier)
- Реализовать как минимум одну базовую модель (инерционный прогноз, рандомная модель, константная модель)

Для всех моделей:

- обосновать гиперпараметры;
- оценивать качество на тестовой выборке;
- использовать **одну и ту же** метрику для всех моделей.

### **5. Оценка неопределённости качества модели**

Используя бутстреп:

- взять размер bootstrap-выборки, совпадающий с размером тренировочной выборки
- исследовать влияние **количества** bootstrap-итераций на величину доверительного интервала (ДИ); по насыщению ДИ подобрать количество bootstrap-итераций;
- для каждой модели:
  - вычислить среднее значение метрики качества,
  - построить ДИ (95%).

**Цель:** обеспечить возможность достоверно судить о различиях моделей между собой.

### **6. Сравнение моделей**

- представить таблицу со средним значением метрики и границами ДИ;
- визуализировать интервалы (например, error bars);
- сделать выводы о статистически значимом превосходстве/непревосходстве какой-то из моделей.

### **7. Аппроксимация временного ряда на выборке новых объектов**

- использовать лучшую модель и построить прогноз;
- визуализировать прогноз vs. true в форме диаграммы рассеяния;

------

## **Визуализации, которые ожидаются в работе:**

- график исходного временного ряда;
- автокорреляционная функция (при необходимости);
- визуализация lag-признаков (тепловая карта таблицы попарных корреляций);
- гистограмма метрики качества для каждой модели;
- доверительные интервалы метрики качества для разных моделей (barplot / errorbars);
- диаграмма рассеяния: прогноз по лучшей модели vs. референсные значения.

------

## **ВЫВОДЫ:**

В отчёте должны содержаться следующие ключевые выводы:

1. **Вывод о том, насколько каждая модель подходит для прогноза исследуемого временного ряда**
    — на основе сравнения качества на train/test, наличия переобучения.
2. **Вывод о достаточности данных**
    — на основании ширины доверительных интервалов метрики.
3. **Вывод о различиях моделей между собой**
    — статистически ли значимы различия в качестве.
4. **Выбор лучшей модели**
    — с аргументацией, основанной на доверительных интервалах, а не только средней метрике.

------

## **Подсказка**

Все обсуждаемые на лекциях элементы — генерация lag-признаков, работа с временными рядами, бутстреп, оценка качества — использовались в последних семинарах.
Ориентируйтесь на подходы, применённые на семинарах в задаче прогноза по данным Jena Climate.