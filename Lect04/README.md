# Лекция №4

## Темы лекции

- Разновидности задач в науках о Земле, решаемых методами машинного обучения  
- Терминология: *прогноз, аппроксимация, анализ*  
- Классы задач:
  - Обучение с учителем (supervised learning)  
  - Обучение без учителя (unsupervised / clustering)  
  - Генеративное / самоконтролируемое обучение  
  - Снижение размерности, поиск структуры  

## Примеры задач (с формализацией)

1. **Даунскейлинг (оценка полей с высоким разрешением на основе низкоразрешённых данных)**  
   - Объект: состояние атмосферы / океана  
   - Признаки: температурные поля, ветровые компоненты и др.  
   - Целевая переменная: поле в высоком разрешении  
   - Мера качества: традиционно MSE, но часто возникает *эффект двойного штрафа*  
   - Альтернативные меры: распределения статистик (экстремумы, градиенты), пространственные меры, F-меры когерентных структур  

2. **Выявление мезомасштабных конвективных систем по спутниковым данным**  
   - Объект: снимок атмосферы  
   - Признаки: многоканальные значения яркости  
   - Целевая переменная: параметры эллипса (место, размеры, ориентация)  
   - Тип: регрессия + (возможно) классификация / выделение  
   - Меры качества: MSE по координатам, F1 / IoU для разметки  

3. **Классификация / кластеризация состояний полярного стратосферного вихря**  
   - Объект: поле геопотенциала  
   - Признаки: значения на сетке  
   - Целевая переменная: отсутствует (задача без учителя)  
   - Метод: кластеризация, поиск «типовых состояний»  
   - Итог: ~12 характерных состояний вихря  

## Схема решения задач supervised learning

- Этапы: обучение → применение  
- Формализация:
  1. Матрица признаков \(X\)  
  2. Вектор (или матрица) целевых значений \(y\)  
  3. Выбор семейства моделей (линейные, нейросети, непараметрические модели и т.п.)  
  4. Функция ошибки / штрафов  
  5. Минимизация ошибки + регуляризация  
- В коде (псевдокод):  
  ```python
  model.fit(X_train, y_train)
  y_pred = model.predict(X_test)

- Важность валидации: перекрёстная проверка, тестовый набор, физически осмысленные проверки

## Примечание: «эффект двойного штрафа»

При пространственных задачах (например, в атмосферных и океанических моделях) простое использование MSE или коэффициента корреляции приводит к так называемому *эффекту двойного штрафа*.

Если модель воспроизводит структуру (например, вихрь или фронт), но со смещением, то ошибка увеличивается дважды:

1. в области, где структура отсутствует в референтных данных,
2. и в области, где структура должна быть, но сместилась.

Таким образом, даже при корректном воспроизведении физических характеристик возникает искусственно завышенная ошибка. Для обхода этого эффекта применяются альтернативные метрики, учитывающие распределения, свойства когерентных структур или другие меры, определяемые экспертно.